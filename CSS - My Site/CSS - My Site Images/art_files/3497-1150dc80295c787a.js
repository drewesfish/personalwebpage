(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3497],{50217:function(e,n,t){"use strict";t.d(n,{Z:function(){return f}});var r=t(47568),o=t(26042),a=t(69396),c=t(99534),i=t(70655),s=t(54098),u=t.n(s),l=t(16260),d=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;function f(e){return p.apply(this,arguments)}function p(){return(p=(0,r.Z)((function(e){var n,t,r,s,f,p,g,v,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:n=e.url,t=(0,c.Z)(e,["url"]),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u()(n,{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},method:"post",body:JSON.stringify((0,a.Z)((0,o.Z)({},t),{format:"pbuf"}))})];case 2:return r=i.sent(),[3,4];case 3:throw(s=i.sent()).statusCode=504,s;case 4:return r.ok?[3,9]:(p=r.headers.get("content-type"))&&p.includes("application/json")?[4,r.json()]:[3,6];case 5:return g=i.sent(),f=g.message,[3,8];case 6:return[4,r.text()];case 7:f=i.sent(),i.label=8;case 8:throw(v=new Error(f||r.statusText)).statusCode=r.status,v;case 9:return[4,r.json()];case 10:if(!(h=i.sent()).token.startsWith("v2.public.")&&!d.test(h.token))throw new l.Z("Expected token to be PASETO- or base64-encoded").setExtras((0,o.Z)({connectionMetadata:h,url:n},t));return[2,h]}}))}))).apply(this,arguments)}},89596:function(e,n,t){"use strict";t.d(n,{d:function(){return l},h:function(){return u}});var r=t(50055),o=t(43484),a=t(34155),c=t(48764).lW,i=a.env.PROXY_SUFFIX||"repl.co",s=a.env.PROXY_FIREWALL_SUFFIX||"firewalledreplit.co";function u(e){var n=e.split(".");if(4!==n.length)throw new Error("Invalid token: should have exactly 4 parts: "+e);for(var t=n[2].replace(/-/g,"+").replace(/_/g,"/");t.length%4;)t+="=";var o=window.atob(t);if(o.length<64)throw new Error("Invalid token: signed part is too short: "+o.length);var a=o.substring(0,o.length-64);try{return r.api.ReplToken.decode(new c(a,"base64"))}catch(i){return JSON.parse(window.atob(a))}}function l(e){var n=u(e).repl.id,t=(0,o.Z)()?s:i,r="".concat(n,".id");return-1!==t.indexOf("repl.localhost:8080")?"ws://".concat(r,".").concat(t):"wss://".concat(r,".").concat(t)}},75240:function(e,n,t){"use strict";t.d(n,{e:function(){return y.e},Z:function(){return L}});var r=t(47568),o=t(26042),a=t(69396),c=t(99534),i=t(70655),s=t(68944),u=t(92876);function l(e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)((function(e){var n,t,r;return(0,i.__generator)(this,(function(o){return n=e.client,t=e.args,r=e.env,[2,new Promise((function(e){var o=n.openChannel({service:"exec"},(function(n){var a=n.error,c=n.channel;if(a)e({error:a.message,output:null});else{if(!c)throw new Error("Expected channel");var i="";c.onCommand((function(e){e.output&&(i+=e.output)})),c.request({exec:{args:t,env:r}}).then((function(n){n.channelClosed?e({error:"Channel closed",output:i||null}):("open"===c.status&&o(),n.error?e({error:n.error,output:i||null}):e({output:i,error:null}))}))}}))}))]}))}))).apply(this,arguments)}var f=t(17780),p=t(55768),g=t(50217),v=t(11163),h=t.n(v),w=t(76650),C=t(34155),E=Boolean(C.env.CAPTCHA_EMBEDS);function m(e){return N.apply(this,arguments)}function N(){return(N=(0,r.Z)((function(e){var n,t,r,c,s,u,l,d,v,C;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(n=e.replId,t=e.isLoggedIn,r=e.overrideClusterMetadata,c=e.retry,s=e.asViewer,!f.l)throw new Error("Expected apollo client");if(u=function(e){w.kg.error("Goval connection failure",{errorMessage:e&&e.message||"unidentified failure",replid:n,reason:"captcha",context:"services"})},l=Boolean(h().query.lite||h().query.embed),d={url:"/data/repls/".concat(n,"/get_connection_metadata"),overrideClusterMetadata:r,clientVersion:"15c2ee6",hCaptchaSiteKey:p.w,isEmbed:l,flags:{},retry:c||0,asViewer:s},t||l&&!E)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,p.Z)()];case 2:return v=i.sent(),[2,(0,g.Z)((0,a.Z)((0,o.Z)({},d),{captcha:v}))];case 3:return C=i.sent(),u(C),[2,m({replId:n,overrideClusterMetadata:r,retry:(c||0)+1,isLoggedIn:t})];case 4:return[2,(0,g.Z)(d)]}}))}))).apply(this,arguments)}var y=t(18962),b=t(5133),O=t(89596);function T(){return _.apply(this,arguments)}function _(){return(_=(0,r.Z)((function(){return(0,i.__generator)(this,(function(e){return"undefined"===typeof document?[2]:document.hidden?[2,new Promise((function(e){var n=function(){document.hidden||(document.removeEventListener("visibilitychange",n),e())};document.addEventListener("visibilitychange",n)}))]:[2]}))}))).apply(this,arguments)}var Z,M=t(16260),S=t(59077),x=t(60977),I=t(75192),k=t(43484),A=t(25108),D=Math.random()<=.1;!function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.PORT_OPEN="PORT_OPEN",e.TOAST="TOAST"}(Z||(Z={}));function P(e){var n=Math.floor(500*Math.random()),t=1e3*Math.pow(2,e);return Math.min(t,3e4)+n}function L(e){var n=e.onUnrecoverableError,t=e.onFirewallDenied,d=(0,b.ZP)();d.setMaxListeners(1e3);var f=null,p=y.e.DISCONNECTED,g=function(e){p!==e&&(p=e,d.emit(Z.CONNECTION_STATE_CHANGE,p))},v=function(){var e,n=function(){e&&(e(),e=void 0)};return{register:function(t,r){n();var o=t,a=r;return window.addEventListener("online",o),window.addEventListener("offline",a),e=function(){window.removeEventListener("online",o),window.removeEventListener("offline",a)},n},unregister:n}}(),h=v.register,C=v.unregister,E=new s.KU;t&&(E.onFirewallDenied=t);E.onDebugLog((function(e){if("breadcrumb"===e.type){var n;n="containerState"===e.message?{containerState:e.data}:"data"in e?e.data:void 0,I.c_.addBreadcrumb({category:"crosisV6",message:e.message,data:n}),u.n_({category:"crosisV6",message:e.message,data:n});var t={replid:null===f||void 0===f?void 0:f.repl.id,language:null===f||void 0===f?void 0:f.repl.language},r="crosis ".concat(e.message);switch(e.message){case"connect timeout":w.kg.error(r,t);break;case"retrying":var a=e.data,i=a.error,s=(0,c.Z)(a,["error"]),l=(0,o.Z)({errorMessage:i.message},t,s);w.kg.error(r,l);break;case"unrecoverable error":var d=(0,o.Z)({errorMessage:e.data.message},t);w.kg.error(r,d);break;case"connecting":case"reconnecting":case"polling fallback":w.kg.info(r,(0,o.Z)({},t,"data"in e?e.data:void 0))}}}));var N=window.location.search.includes("debug=1");return N&&E.onDebugLog((function(e){"log"===e.type&&A.log("in"===e.log.direction?"--\x3e":"<--",e.log.cmd)})),{onPortOpened:function(e){return d.on(Z.PORT_OPEN,e),function(){d.removeListener(Z.PORT_OPEN,e)}},onToast:function(e){return d.on(Z.TOAST,e),function(){d.removeListener(Z.TOAST,e)}},onConnectionStateChanged:function(e){return d.on(Z.CONNECTION_STATE_CHANGE,e),function(){d.removeListener(Z.CONNECTION_STATE_CHANGE,e)}},connect:function(e){var t=this,u=e.context,l=e.customConnectionMetadata,v=e.fetchConnectionMetadataExtras,C=(0,c.Z)(e,["context","customConnectionMetadata","fetchConnectionMetadataExtras"]);p!==y.e.DISCONNECTED&&E.close(),f=u;var b=null;h((function(){t.connect((0,o.Z)({context:u,customConnectionMetadata:l,fetchConnectionMetadataExtras:v},C))}),(function(){t.close()}));var O=this,_=function(){var e=(0,r.Z)((function(e){var n,t,r,a,c,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=e.chan0,t=e.gurl,r=e.isFirst,"open"!==n.status?[2]:(a=w.kg.timeStart({gurl:t}),c=setTimeout((function(){w.kg.error("ping with no response",{gurl:t}),O.connect((0,o.Z)({context:u,customConnectionMetadata:l,fetchConnectionMetadataExtras:v},C))}),3e4),[4,n.request({ping:{}})]);case 1:return s=i.sent().channelClosed,clearTimeout(c),s?[2]:(r?a("latency to pid1",{type:"startup"}):D&&a("latency to pid1",{type:"periodic"}),setTimeout((function(){return _({chan0:n,gurl:t,isFirst:!1})}),1e3),[2])}}))}));return function(n){return e.apply(this,arguments)}}(),I={getNextRetryDelayMs:P,context:u,reuseConnectionMetadata:!0,fetchConnectionMetadata:function(){var e=(0,r.Z)((function(e){var n,t,r,c,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return window.performance.clearMarks(w.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(w.Iy.fetchConnectionMetadataPageInvisibleEnd),n=w.kg.timeStart(),window.performance.mark(w.Iy.fetchConnectionMetadataPageInvisibleStart),[4,T()];case 1:i.sent(),window.performance.mark(w.Iy.fetchConnectionMetadataPageInvisibleEnd),n("page visible fetch connection metadata"),i.label=2;case 2:return[4,(0,S.Z)()];case 3:if(t=i.sent(),e.aborted)return[2,{error:s.gS.Aborted}];if(!t&&l&&b!==l.token)return b=l.token,[2,(0,a.Z)((0,o.Z)({},l),{error:null})];r=w.kg.timeStart({hasCustomFetch:Boolean(C.fetchConnectionMetadata)}),i.label=4;case 4:return i.trys.push([4,9,,10]),C.fetchConnectionMetadata?[4,C.fetchConnectionMetadata()]:[3,6];case 5:return c=i.sent(),[3,8];case 6:return[4,m((0,o.Z)({asViewer:u.asViewer,replId:u.repl.id,isLoggedIn:Boolean(u.currentUser),overrideClusterMetadata:t},v))];case 7:c=i.sent(),i.label=8;case 8:return[3,10];case 9:if(d=i.sent(),e.aborted)return[2,{error:s.gS.Aborted}];switch(d&&d.statusCode){case 400:case 408:case 409:case 429:case 500:case 502:case 503:case 504:return[2,{error:s.gS.Retriable}]}throw d;case 10:return e.aborted?[2,{error:s.gS.Aborted}]:(N&&A.log("connecting",c),r("fetched connection metadata"),[2,(0,a.Z)((0,o.Z)({},c),{error:null})])}}))}));return function(n){return e.apply(this,arguments)}}(),pollingHost:"gp-v2.replit.com"};(0,k.Z)()&&(I.pollingHost="gp-v2.firewalledreplit.com");var L=window.performance.now(),R=0;E.open(I,(function(e){var t,r=e.channel;if(e.error)return g(y.e.DISCONNECTED),function(){};if(!r)throw new Error("Expected channel");N&&A.log("connected",{replId:u.repl.id});var o=r.onCommand((function(e){switch(e.body){case"portOpen":if(!e.portOpen)throw new Error("portOpen only handles portOpen commands");if(!e.portOpen.forwarded)return;var t=e.portOpen.port||0;if(5901===t)return;(0,x.j)(x.U3.PORT_OPENED,{port:t,isVnc:5900===t}),d.emit(Z.PORT_OPEN,{port:t,isVnc:5900===t});break;case"protocolError":var r,o;n(new M.Z("goval panic").setExtra("message",null!==(o=null===(r=e.protocolError)||void 0===r?void 0:r.text)&&void 0!==o?o:"protocol error"));break;case"toast":var a,c=null===(a=e.toast)||void 0===a?void 0:a.text;if(!c)break;d.emit(Z.TOAST,c)}}));_({chan0:r,gurl:null===(t=E.getConnectionMetadata())||void 0===t?void 0:t.gurl,isFirst:!0}),window.v6ws=E.ws;var a=window.performance.now()-L;return w.kg.info("connected to pid1",{time:a,reconnectCount:R,replid:u.repl.id,language:u.repl.language}),g(y.e.CONNECTED),function(e){var n=e.willReconnect;if(o(),!n)return f=null,void g(y.e.DISCONNECTED);L=window.performance.now(),R++,g(y.e.CONNECTING)}})),g(y.e.CONNECTING)},openChannel:function(e,t){return E.openChannel(e,(function(e){var r,o=null===e||void 0===e||null===(r=e.channel)||void 0===r?void 0:r.onCommand((function(e){var t,r;"protocolError"===e.body&&n(new M.Z("goval panic").setExtra("message",null!==(r=null===(t=e.protocolError)||void 0===t?void 0:t.text)&&void 0!==r?r:"protocol error"))})),a=t(e);return function(e){a&&a(e),o&&o()}}))},getConnectionState:function(){return p},exec:(0,r.Z)((function(){var e,n,t,r=arguments;return(0,i.__generator)(this,(function(o){for(e=r.length,n=new Array(e),t=0;t<e;t++)n[t]=r[t];return[2,l({client:E,args:n})]}))})),execWithEnv:function(){var e=(0,r.Z)((function(e){var n,t,r,o=arguments;return(0,i.__generator)(this,(function(a){for(n=o.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=o[r];return[2,l({client:E,args:t,env:e})]}))}));return function(n){return e.apply(this,arguments)}}(),close:function(){p!==y.e.DISCONNECTED&&E.close()},destroy:function(){E.destroy(),d.removeAllListeners(),C()},client:function(){return E},getConnectionMetadata:function(){return E.getConnectionMetadata()},getContext:function(){return f},getVncUrl:function(){var e=E.getConnectionMetadata();if(!e||p!==y.e.CONNECTED)throw new Error("Cannot get vnc url when container is not connected");return(0,O.d)(e.token)},unrecoverableError:function(e,t){E.destroy(),d.removeAllListeners(),n(t?M.Z.wrap(e).setExtras(t):e)}}}},18962:function(e,n,t){"use strict";var r;t.d(n,{e:function(){return r}}),function(e){e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.DISCONNECTED="DISCONNECTED"}(r||(r={}))},59077:function(e,n,t){"use strict";t.d(n,{Z:function(){return l},t:function(){return u}});var r=t(47568),o=t(70655),a=t(35642),c=(t(54098),t(25108));function i(){return s.apply(this,arguments)}function s(){return(s=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return a.Z.get("gurl")?(c.log("Getting gurl from localstorage"),[2,a.Z.get("gurl")]):[2,null]}))}))).apply(this,arguments)}function u(e){var n=function(e){var n;try{n=new URL(e)}catch(r){return c.log("failed to parse gurl"),c.error(r),null}var t={secure:!1,port:""+n.port,host:n.hostname};return"wss:"===n.protocol?t.secure=!0:"ws:"!==n.protocol&&c.log(e,"Expected gurl protocol to be ws or wss, assuming insecure connection"),t.port||(t.port=t.secure?"443":"80"),t}(e);if(!n)return null;var t=n.secure,r=n.host,o=n.port;return"eval.repl.it"===r||"gp-v2.replit.com"===r||"gp-v2.firewalledreplit.com"===r||"eval.replit.com"===r?null:{id:"development",gurl:"ws".concat(t?"s":"","://").concat(r,":").concat(o),conmanURL:"http".concat(t?"s":"","://").concat(r,":").concat(o),proxy:"http".concat(t?"s":"","://").concat(r.replace("eval","proxy"),":").concat(o)}}function l(){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,i()];case 1:return(e=n.sent())?[2,u(e)]:[2,null]}}))}))).apply(this,arguments)}},77020:function(){}}]);
//# sourceMappingURL=3497-1150dc80295c787a.js.map